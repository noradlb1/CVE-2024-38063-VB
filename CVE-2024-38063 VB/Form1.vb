Imports System.Management
Imports System.Net
Imports System.Net.NetworkInformation

Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        LoadNetworkAdapters()
    End Sub

    ' تحميل محولات الشبكة في القائمة
    Private Sub LoadNetworkAdapters()
        ListBoxAdapters.Items.Clear()

        For Each ni As NetworkInterface In NetworkInterface.GetAllNetworkInterfaces()
            ListBoxAdapters.Items.Add(ni.Name)
        Next
    End Sub

    ' التحقق مما إذا كان IPv6 مفعلاً
    Private Function IsIPv6Enabled(adapterName As String) As Boolean
        Dim adapters As NetworkInterface() = NetworkInterface.GetAllNetworkInterfaces()

        For Each adapter As NetworkInterface In adapters
            If adapter.Name = adapterName Then
                For Each unicastAddress As UnicastIPAddressInformation In adapter.GetIPProperties().UnicastAddresses
                    If unicastAddress.Address.AddressFamily = Sockets.AddressFamily.InterNetworkV6 Then
                        Return True
                    End If
                Next
            End If
        Next

        Return False
    End Function


    ' تمكين IPv6
    Private Sub EnableIPv6(adapterName As String)
        ExecuteNetshCommand(adapterName, True)
    End Sub

    ' تعطيل IPv6
    Private Sub DisableIPv6(adapterName As String)
        ExecuteNetshCommand(adapterName, False)
    End Sub

    ' تنفيذ أمر Netsh لتمكين أو تعطيل IPv6
    Private Sub ExecuteNetshCommand(adapterName As String, enable As Boolean)
        Dim process As New Process()
        process.StartInfo.FileName = "netsh"
        process.StartInfo.Arguments = $"interface ipv6 set interface ""{adapterName}"" {If(enable, "enable", "disable")}"
        process.StartInfo.UseShellExecute = False
        process.StartInfo.RedirectStandardOutput = True
        process.StartInfo.CreateNoWindow = True
        process.Start()
        process.WaitForExit()
    End Sub

    ' زر عرض المحولات التي تم تفعيل IPv6 عليها
    Private Sub BtnShowIPv6Enabled_Click(sender As Object, e As EventArgs) Handles BtnShowIPv6Enabled.Click
        ListBoxAdapters.Items.Clear()

        For Each ni As NetworkInterface In NetworkInterface.GetAllNetworkInterfaces()
            If IsIPv6Enabled(ni.Name) Then
                ListBoxAdapters.Items.Add(ni.Name & " : IPv6 Enabled")
            End If
        Next
    End Sub

    ' زر تمكين IPv6
    Private Sub BtnEnableIPv6_Click(sender As Object, e As EventArgs) Handles BtnEnableIPv6.Click
        If ListBoxAdapters.SelectedItem IsNot Nothing Then
            EnableIPv6(ListBoxAdapters.SelectedItem.ToString())
            MessageBox.Show("IPv6 Enabled on " & ListBoxAdapters.SelectedItem.ToString())
        End If
    End Sub

    ' زر تعطيل IPv6
    Private Sub BtnDisableIPv6_Click(sender As Object, e As EventArgs) Handles BtnDisableIPv6.Click
        If ListBoxAdapters.SelectedItem IsNot Nothing Then
            DisableIPv6(ListBoxAdapters.SelectedItem.ToString())
            MessageBox.Show("IPv6 Disabled on " & ListBoxAdapters.SelectedItem.ToString())
        End If
    End Sub
End Class

